import"./modulepreload-polyfill-B5Qt9EMX.js";class r{constructor(){this.isExpanded=!1,this.currentWeather=null,this.currentLocation=null,this.init()}async init(){this.setupEventListeners(),await this.loadWeatherData(),this.setupAutoUpdate()}setupEventListeners(){const e=document.getElementById("weatherBall");e.addEventListener("click",()=>{this.toggleExpand()}),document.addEventListener("click",t=>{!e.contains(t.target)&&this.isExpanded&&this.collapse()}),chrome.runtime&&chrome.runtime.onMessage.addListener(t=>{t.type==="weather.updated"&&this.updateWeatherDisplay(t.data)})}async loadWeatherData(){try{const e=await chrome.runtime.sendMessage({type:"weather.getCurrent"});e.success&&e.data&&(this.currentWeather=e.data,this.updateWeatherDisplay(e.data));const t=await chrome.runtime.sendMessage({type:"location.getCurrent"});t.success&&t.data&&(this.currentLocation=t.data)}catch(e){console.error("åŠ è½½å¤©æ°”æ•°æ®å¤±è´¥:",e),this.showError()}}updateWeatherDisplay(e){if(!e)return;const t=Math.round(e.env.temperature),s=e.location.name||"å½“å‰ä½ç½®",n=e.weather.code,o={clear:"â˜€ï¸",cloudy:"â˜ï¸",rain:"ğŸŒ§ï¸",snow:"â„ï¸",fog:"ğŸŒ«ï¸",thunderstorm:"â›ˆï¸"},d={clear:"æ™´æœ—",cloudy:"å¤šäº‘",rain:"ä¸‹é›¨",snow:"ä¸‹é›ª",fog:"æœ‰é›¾",thunderstorm:"é›·æš´"};document.getElementById("weatherIcon").textContent=o[n]||"ğŸŒ¤ï¸",document.getElementById("weatherTemp").textContent=`${t}Â°`,document.getElementById("weatherLocation").textContent=s,document.getElementById("weatherDescription").textContent=d[n]||"æœªçŸ¥";const a=e.weather.windSpeedMps||0;e.weather.windDirDeg,document.getElementById("weatherWind").textContent=a>0?`${a.toFixed(1)} m/s`:"æ— é£"}toggleExpand(){const e=document.getElementById("weatherBall");this.isExpanded=!this.isExpanded,this.isExpanded?e.classList.add("expanded"):e.classList.remove("expanded")}collapse(){document.getElementById("weatherBall").classList.remove("expanded"),this.isExpanded=!1}setupAutoUpdate(){setInterval(()=>{this.loadWeatherData()},5*60*1e3)}showError(){document.getElementById("weatherIcon").textContent="âŒ",document.getElementById("weatherTemp").textContent="--Â°",document.getElementById("weatherLocation").textContent="åŠ è½½å¤±è´¥",document.getElementById("weatherDescription").textContent="æ— æ³•è·å–å¤©æ°”æ•°æ®",document.getElementById("weatherWind").textContent="--"}}new r;
