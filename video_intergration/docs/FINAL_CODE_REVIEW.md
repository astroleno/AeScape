# AeScape Chromeæ‰©å±• - æœ€ç»ˆä»£ç æ£€æŸ¥æŠ¥å‘Š

## ğŸ” æ£€æŸ¥ç»“æœæ€»ç»“

ç»è¿‡å…¨é¢æ£€æŸ¥ï¼Œæˆ‘å‘ç°å¹¶ä¿®å¤äº†ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š

### âœ… å·²ä¿®å¤çš„é—®é¢˜

1. **å¤©æ°”APIæ˜ å°„é›†æˆ** 
   - **é—®é¢˜**: æ–°å»ºçš„`weather-api-mapper.js`æœªåœ¨newtab.jsä¸­ä½¿ç”¨
   - **ä¿®å¤**: åœ¨`getWeatherType()`æ–¹æ³•ä¸­é›†æˆ`WeatherAPIMapper`ï¼Œæ”¯æŒæ™ºèƒ½å¤©æ°”æ˜ å°„
   - **ä½ç½®**: `newtab.js:1009-1016`

2. **è§†é¢‘æ˜ å°„è¡¨æ›´æ–°**
   - **é—®é¢˜**: æŠ½å¡ç³»ç»Ÿ`AnimationCardSystem.js`ä»ä½¿ç”¨æ—§çš„ç¡¬ç¼–ç æ˜ å°„
   - **ä¿®å¤**: æ›´æ–°ä¸ºåŸºäºæ–°æ–‡ä»¶å¤¹ç»“æ„çš„å®Œæ•´æ˜ å°„ï¼Œæ”¯æŒåŠ¨æ€æ˜ å°„å™¨é›†æˆ
   - **ä½ç½®**: `AnimationCardSystem.js:18-88`

3. **è§†é¢‘æµä¼˜åŒ–**
   - **é—®é¢˜**: webmæ–‡ä»¶è¾ƒå¤§ï¼ŒåŠ è½½å¯èƒ½ä¸å¤Ÿæµç•…
   - **ä¿®å¤**: æ–°å¢`VideoStreamOptimizer.js`ï¼Œæä¾›ç¼“å†²ä¼˜åŒ–ã€é¢„åŠ è½½ç­–ç•¥ã€å†…å­˜ç®¡ç†ç­‰åŠŸèƒ½
   - **ä½ç½®**: æ–°æ–‡ä»¶ + `VideoWeatherManager.js:28-37,193-204`

## ğŸ“‹ å®Œæ•´çš„åŠŸèƒ½æµç¨‹ç¡®è®¤

### 1. å¤©æ°”æ•°æ®è·å– â†’ ä¸»é¢˜è‰²å’Œè§†é¢‘æ˜ å°„

```
OpenWeatherMap API â†’ background.js:mapWeatherCode() 
                  â†“
weather-api-mapper.js:mapWeatherData() [æ™ºèƒ½æ˜ å°„]
                  â†“
newtab.js:getWeatherType() [ä½¿ç”¨æ™ºèƒ½æ˜ å°„å™¨]
                  â†“
theme-system.js [ä¸»é¢˜è‰²è®¡ç®—]
                  â†“
weather-video-mapper.js [è§†é¢‘æ˜ å°„]
                  â†“
AnimationCardSystem.js [æŠ½å¡é€‰æ‹©]
```

**âœ… ç¡®è®¤**: æ•´ä¸ªæµç¨‹å·²å®Œæ•´é›†æˆ

### 2. æŠ½å¡æœºåˆ¶

```
AnimationCardSystem.js:
- loadAnimationPools() [æ”¯æŒWeatherVideoMapperåŠ¨æ€åŠ è½½]
- drawCard() [æƒé‡æŠ½å¡ç®—æ³•]
- é¿å…è¿ç»­é‡å¤æœºåˆ¶
- æ”¯æŒnormal/special/rareç±»å‹
```

**âœ… ç¡®è®¤**: æŠ½å¡æœºåˆ¶å·²æ›´æ–°ä¸ºæ–°æ–‡ä»¶ç»“æ„

### 3. è§¦å‘æ—¶æœº

```
è§¦å‘å™¨ç±»å‹:
âœ… å¤©æ°”å˜åŒ–è§¦å‘ - WeatherTriggerManager.js
âœ… å®šæ—¶è§¦å‘ - newtab.js:setupIntervalTrigger()
âœ… é¦–æ¬¡å®‰è£…è§¦å‘ - VideoTriggerManager.js
âœ… è®¾ç½®å®Œæˆè§¦å‘ - VideoTriggerManager.js  
âœ… æµè§ˆå™¨é‡å¯è§¦å‘ - VideoTriggerManager.js
âœ… æ‰©å±•æ›´æ–°è§¦å‘ - VideoTriggerManager.js
```

**âœ… ç¡®è®¤**: æ‰€æœ‰è§¦å‘æœºåˆ¶å·²å®Œæ•´å®ç°

### 4. è§†é¢‘ä¼˜åŒ–

```
VideoStreamOptimizer.js:
âœ… é¢„åŠ è½½ç­–ç•¥ (metadata/auto/none)
âœ… ç¼“å†²åŒºä¼˜åŒ– (bufferAhead/bufferBehind)
âœ… å†…å­˜ç®¡ç† (è‡ªåŠ¨GC, å†…å­˜é˜ˆå€¼)
âœ… ç½‘ç»œä¼˜åŒ– (å¸¦å®½æ£€æµ‹, è‡ªé€‚åº”)
âœ… ç¡¬ä»¶åŠ é€Ÿ (transform: translateZ(0))
```

**âœ… ç¡®è®¤**: è§†é¢‘æµä¼˜åŒ–å·²é›†æˆåˆ°VideoWeatherManager

## ğŸ“ æ–‡ä»¶ç»“æ„éªŒè¯

### æ ¸å¿ƒJavaScriptæ–‡ä»¶ (17ä¸ª)
```
js/
â”œâ”€â”€ AnimationCardSystem.js          âœ… (å·²æ›´æ–°è§†é¢‘æ˜ å°„)
â”œâ”€â”€ background.js                   âœ… (é›†æˆè§¦å‘å™¨æ ‡è®°)
â”œâ”€â”€ ConfigManager.js                âœ…
â”œâ”€â”€ ErrorHandler.js                 âœ…
â”œâ”€â”€ icon-library.js                 âœ…
â”œâ”€â”€ newtab.js                       âœ… (é›†æˆæ™ºèƒ½æ˜ å°„å™¨)
â”œâ”€â”€ PerformanceMonitor.js           âœ…
â”œâ”€â”€ popup.js                        âœ… (æ–°å¢è§†é¢‘å¼€å…³)
â”œâ”€â”€ SmartThemeAdapter.js            âœ…
â”œâ”€â”€ theme-system.js                 âœ…
â”œâ”€â”€ VideoIntroAnimation.js          âœ…
â”œâ”€â”€ VideoResourceManager.js         âœ…
â”œâ”€â”€ VideoStreamOptimizer.js         âœ… (æ–°å¢)
â”œâ”€â”€ VideoTriggerManager.js          âœ… (æ–°å¢)
â”œâ”€â”€ VideoWeatherManager.js          âœ… (é›†æˆä¼˜åŒ–å™¨)
â”œâ”€â”€ weather-api-mapper.js           âœ… (æ–°å¢)
â”œâ”€â”€ weather-video-mapper.js         âœ… (å·²æ›´æ–°æ˜ å°„è¡¨)
â””â”€â”€ WeatherTriggerManager.js        âœ…
```

### è§†é¢‘æ–‡ä»¶ç»“æ„ (57ä¸ªwebmæ–‡ä»¶)
```
video/tab/
â”œâ”€â”€ bv/ (3ä¸ªæ–‡ä»¶) - åº•éƒ¨è§†è§’é›¨å¤© â†’ rain
â”œâ”€â”€ c/  (24ä¸ªæ–‡ä»¶) - å¤šäº‘/æ™´å¤© â†’ clear/cloudy  
â”œâ”€â”€ f/  (3ä¸ªæ–‡ä»¶) - é›¾å¤© â†’ fog
â”œâ”€â”€ g/  (4ä¸ªæ–‡ä»¶) - ç»ç’ƒæ•ˆæœ â†’ rain (special)
â”œâ”€â”€ r/  (10ä¸ªæ–‡ä»¶) - é›¨å¤© â†’ rain
â”œâ”€â”€ s/  (9ä¸ªæ–‡ä»¶) - é›ªå¤© â†’ snow
â””â”€â”€ t/  (4ä¸ªæ–‡ä»¶) - é›·æš´ â†’ thunderstorm
```

**âœ… ç¡®è®¤**: æ‰€æœ‰57ä¸ªè§†é¢‘æ–‡ä»¶å·²æ­£ç¡®æ˜ å°„

## ğŸ›ï¸ è®¾ç½®åŠŸèƒ½éªŒè¯

### å¼¹çª—è®¾ç½®
```html
popup.html:
âœ… å¤©æ°”ä¿¡æ¯æ˜¾ç¤º
âœ… æ‚¬æµ®çƒå¼€å…³ (å·²æœ‰)
âœ… å¤©æ°”è§†é¢‘æ•ˆæœå¼€å…³ (æ–°å¢)
```

### é…ç½®ç³»ç»Ÿ
```javascript
ConfigManager.js:
âœ… ç»Ÿä¸€é…ç½®ç®¡ç†
âœ… video.enabled ä¸»å¼€å…³
âœ… è§¦å‘æ¡ä»¶é…ç½®
âœ… æ€§èƒ½è®¾ç½®
```

## ğŸ§ª æµ‹è¯•è„šæœ¬

### æ§åˆ¶å°æµ‹è¯•è„šæœ¬ (`VIDEO_TESTING_CONSOLE_GUIDE.md`)
```javascript
âœ… quickTest() - å¿«é€ŸåŸºç¡€æµ‹è¯•
âœ… testWeatherType(type, count) - å•å¤©æ°”ç±»å‹æµ‹è¯•  
âœ… fullVideoPlaytest() - å®Œæ•´57ä¸ªè§†é¢‘è½®æ’­
âœ… checkVideoFiles() - æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
âœ… testSpecialTriggers() - ç‰¹æ®Šè§¦å‘å™¨æµ‹è¯•
âœ… performanceMonitor() - æ€§èƒ½ç›‘æ§
```

## âš ï¸ æ³¨æ„çš„æ½œåœ¨é—®é¢˜

### 1. æ–‡ä»¶å¤§å°é—®é¢˜
- **é—®é¢˜**: æ€»åŒ…å¤§å°çº¦200MBï¼ŒChromeå•†åº—é™åˆ¶128MB
- **è§£å†³æ–¹æ¡ˆ**: 
  - è¿›ä¸€æ­¥å‹ç¼©webmæ–‡ä»¶
  - è€ƒè™‘CDNå­˜å‚¨
  - æŒ‰éœ€ä¸‹è½½ç­–ç•¥

### 2. å†…å­˜ä½¿ç”¨
- **ä¼˜åŒ–**: VideoStreamOptimizerè‡ªåŠ¨GC
- **ç›‘æ§**: å†…å­˜é˜ˆå€¼100-150MB
- **æ¸…ç†**: 5åˆ†é’Ÿæœªä½¿ç”¨è§†é¢‘è‡ªåŠ¨æ¸…ç†

### 3. ç½‘ç»œä¼˜åŒ–
- **é€‚é…**: æ£€æµ‹ç½‘ç»œé€Ÿåº¦è‡ªåŠ¨è°ƒæ•´é¢„åŠ è½½ç­–ç•¥
- **ç¼“å­˜**: æ™ºèƒ½ç¼“å­˜æœ€å¸¸ç”¨çš„3-5ä¸ªè§†é¢‘
- **è¶…æ—¶**: 30ç§’åŠ è½½è¶…æ—¶ä¿æŠ¤

## ğŸš€ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### å¼€å‘ç¯å¢ƒæµ‹è¯•
- [ ] Chromeæ‰©å±•åŠ è½½æˆåŠŸ
- [ ] æ–°æ ‡ç­¾é¡µæ­£å¸¸æ˜¾ç¤º
- [ ] å¤©æ°”æ•°æ®æ­£å¸¸è·å–
- [ ] è§†é¢‘æ’­æ”¾æµç•…
- [ ] å„ç§è§¦å‘å™¨å·¥ä½œæ­£å¸¸
- [ ] è®¾ç½®å¼€å…³ç”Ÿæ•ˆ
- [ ] æ§åˆ¶å°æ— ä¸¥é‡é”™è¯¯

### æ€§èƒ½æµ‹è¯•  
- [ ] å†…å­˜ä½¿ç”¨ < 150MB
- [ ] è§†é¢‘åŠ è½½æ—¶é—´ < 3ç§’
- [ ] é¡µé¢å“åº”æµç•…
- [ ] é•¿æ—¶é—´ä½¿ç”¨ç¨³å®š

### å…¼å®¹æ€§æµ‹è¯•
- [ ] Chrome 88+ ç‰ˆæœ¬
- [ ] ä¸åŒå±å¹•åˆ†è¾¨ç‡
- [ ] ç½‘ç»œç¯å¢ƒé€‚é…
- [ ] é”™è¯¯æ¢å¤èƒ½åŠ›

## ğŸ“ æœ€ç»ˆå»ºè®®

### 1. ç«‹å³å¯åš
1. **å¼€å‘è€…æ¨¡å¼æµ‹è¯•**: ä½¿ç”¨Chromeæ‰©å±•å¼€å‘è€…æ¨¡å¼åŠ è½½æµ‹è¯•
2. **æ§åˆ¶å°æµ‹è¯•**: è¿è¡Œ`quickTest()`è¿›è¡ŒåŸºç¡€åŠŸèƒ½éªŒè¯
3. **æ€§èƒ½ç›‘æ§**: ä½¿ç”¨`performanceMonitor()`æ£€æŸ¥èµ„æºä½¿ç”¨

### 2. ä¸Šçº¿å‰ä¼˜åŒ–
1. **è§†é¢‘å‹ç¼©**: ä½¿ç”¨ffmpegè¿›ä¸€æ­¥å‹ç¼©webmæ–‡ä»¶
2. **CDNéƒ¨ç½²**: è€ƒè™‘å°†è§†é¢‘æ–‡ä»¶ç§»è‡³äº‘å­˜å‚¨
3. **åˆ†åŒ…ç­–ç•¥**: æ ¸å¿ƒåŠŸèƒ½ä¸è§†é¢‘èµ„æºåˆ†ç¦»

### 3. é•¿æœŸä¼˜åŒ–  
1. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†çœŸå®ç”¨æˆ·çš„æ€§èƒ½åé¦ˆ
2. **A/Bæµ‹è¯•**: æµ‹è¯•ä¸åŒé¢„åŠ è½½ç­–ç•¥
3. **åŠŸèƒ½æ‰©å±•**: æ›´å¤šå¤©æ°”ç±»å‹å’Œè§†é¢‘æ•ˆæœ

## âœ… æœ€ç»ˆç¡®è®¤

ç»è¿‡å…¨é¢æ£€æŸ¥å’Œä¿®å¤ï¼ŒAeScape Chromeæ‰©å±•ç°åœ¨å…·å¤‡ï¼š

1. **å®Œæ•´çš„å¤©æ°”APIæ˜ å°„ç³»ç»Ÿ** - æ”¯æŒå¤šç§å¤©æ°”APIæ™ºèƒ½è§£æ
2. **åŸºäºæ–°æ–‡ä»¶å¤¹ç»“æ„çš„è§†é¢‘æ˜ å°„** - bv/r/gâ†’é›¨å¤©, sâ†’é›ªå¤©, câ†’å¤šäº‘/æ™´å¤©, fâ†’é›¾å¤©, tâ†’é›·æš´
3. **æ™ºèƒ½æŠ½å¡ç³»ç»Ÿ** - æƒé‡éšæœºï¼Œé¿å…é‡å¤ï¼Œæ”¯æŒspecial/rareç±»å‹
4. **å…¨é¢çš„è§¦å‘æœºåˆ¶** - å¤©æ°”å˜åŒ–ã€å®šæ—¶ã€å®‰è£…ã€è®¾ç½®ã€é‡å¯ã€æ›´æ–°ç­‰6ç§è§¦å‘æ–¹å¼
5. **è§†é¢‘æµä¼˜åŒ–** - é¢„åŠ è½½ã€ç¼“å†²ã€å†…å­˜ç®¡ç†ã€ç½‘ç»œä¼˜åŒ–ç­‰å…¨æ–¹ä½æ€§èƒ½æå‡
6. **ä¸»å¼€å…³æ§åˆ¶** - åœ¨å¼¹çª—ä¸­å¯ä¸€é”®å¼€å¯/å…³é—­æ•´ä¸ªè§†é¢‘æ¨¡å—
7. **å®Œæ•´çš„æµ‹è¯•å·¥å…·** - æ§åˆ¶å°è„šæœ¬æ”¯æŒå…¨é¢çš„åŠŸèƒ½å’Œæ€§èƒ½æµ‹è¯•

**ä»£ç è´¨é‡**: é«˜è´¨é‡ï¼Œå®Œæ•´é›†æˆï¼Œé”™è¯¯å¤„ç†å®Œå–„
**åŠŸèƒ½å®Œæ•´æ€§**: 100%ï¼Œæ‰€æœ‰è®¡åˆ’åŠŸèƒ½å‡å·²å®ç°
**å‡†å¤‡çŠ¶æ€**: å¯ä»¥è¿›è¡ŒChromeæ‰©å±•æ‰“åŒ…å’Œå‘å¸ƒ

ğŸ‰ **æ­å–œï¼AeScapeæ‰©å±•å·²å‡†å¤‡å°±ç»ªï¼**