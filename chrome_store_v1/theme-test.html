<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>天景 AeScape - 主题颜色测试</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: var(--theme-gradient, linear-gradient(135deg, rgba(66, 165, 245, 0.12) 0%, rgba(102, 187, 106, 0.08) 100%));
      color: var(--theme-text, rgba(255, 255, 255, 0.95));
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 1rem;
      opacity: 0.8;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }

    .control-group {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .control-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .button-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }

    .test-btn {
      padding: 10px 12px;
      border: none;
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.15);
      color: inherit;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .test-btn:hover {
      background: rgba(0, 0, 0, 0.25);
      transform: translateY(-1px);
    }

    .test-btn.active {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.3);
    }

    .time-slider {
      width: 100%;
      margin: 10px 0;
      -webkit-appearance: none;
      appearance: none;
      height: 6px;
      border-radius: 3px;
      background: rgba(255, 255, 255, 0.2);
      outline: none;
    }

    .time-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.9);
      cursor: pointer;
    }

    .time-display {
      text-align: center;
      font-size: 1.2rem;
      font-weight: 600;
      margin: 10px 0;
    }

    .preview-section {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .preview-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 20px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .preview-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .theme-info {
      font-size: 0.9rem;
      line-height: 1.6;
      opacity: 0.9;
    }

    .theme-info div {
      margin-bottom: 8px;
    }

    .color-swatch {
      display: inline-block;
      width: 20px;
      height: 20px;
      border-radius: 4px;
      margin-right: 8px;
      vertical-align: middle;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .floating-ball-preview {
      position: relative;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }

    .preview-ball {
      width: 64px;
      height: 64px;
      background: var(--theme-gradient);
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--theme-text);
      font-weight: 600;
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .preview-ball:hover {
      transform: scale(1.1);
    }

    .ball-temp {
      font-size: 14px;
      line-height: 1;
    }

    .ball-icon {
      width: 16px;
      height: 16px;
      margin-bottom: 2px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">天景 AeScape</div>
    <div class="subtitle">主题颜色系统测试</div>
  </div>

  <div class="controls">
    <div class="control-group">
      <div class="control-title">天气类型</div>
      <div class="button-grid">
        <button class="test-btn active" data-weather="clear">晴天</button>
        <button class="test-btn" data-weather="cloudy">多云</button>
        <button class="test-btn" data-weather="rain">雨天</button>
        <button class="test-btn" data-weather="snow">雪天</button>
        <button class="test-btn" data-weather="fog">雾天</button>
        <button class="test-btn" data-weather="thunderstorm">雷暴</button>
      </div>
    </div>

    <div class="control-group">
      <div class="control-title">时间段选择</div>
      <div class="button-grid">
        <button class="test-btn" data-time="5" data-time-name="黎明">05:00 黎明</button>
        <button class="test-btn" data-time="8" data-time-name="早晨">08:00 早晨</button>
        <button class="test-btn" data-time="10" data-time-name="上午">10:00 上午</button>
        <button class="test-btn active" data-time="12" data-time-name="中午">12:00 中午</button>
        <button class="test-btn" data-time="15" data-time-name="下午">15:00 下午</button>
        <button class="test-btn" data-time="18" data-time-name="黄昏">18:00 黄昏</button>
        <button class="test-btn" data-time="19" data-time-name="傅晚">19:00 傅晚</button>
        <button class="test-btn" data-time="22" data-time-name="夜晚">22:00 夜晚</button>
      </div>
    </div>

    <div class="control-group">
      <div class="control-title">精确时间控制</div>
      <div class="time-display" id="time-display">12:00</div>
      <input type="range" class="time-slider" id="time-slider" min="0" max="23" value="12">
      <div style="display: flex; justify-content: space-between; font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">
        <span>00:00</span>
        <span>12:00</span>
        <span>23:00</span>
      </div>
    </div>

    <div class="control-group">
      <div class="control-title">经典组合测试</div>
      <div class="button-grid">
        <button class="test-btn" onclick="testScenario('clear', 8)">晴天早晨</button>
        <button class="test-btn" onclick="testScenario('clear', 14)">晴天下午</button>
        <button class="test-btn" onclick="testScenario('clear', 18)">晴天日落</button>
        <button class="test-btn" onclick="testScenario('clear', 22)">晴天夜晚</button>
        <button class="test-btn" onclick="testScenario('rain', 10)">雨天白天</button>
        <button class="test-btn" onclick="testScenario('rain', 20)">雨天夜晚</button>
        <button class="test-btn" onclick="testScenario('thunderstorm', 15)">雷暴下午</button>
        <button class="test-btn" onclick="testScenario('snow', 10)">雪天上午</button>
      </div>
    </div>

    <div class="control-group">
      <div class="control-title">全天气测试</div>
      <div class="button-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); font-size: 0.8rem;">
        <button class="test-btn" onclick="testAllWeatherAtTime(8)">08:00全天气</button>
        <button class="test-btn" onclick="testAllWeatherAtTime(12)">12:00全天气</button>
        <button class="test-btn" onclick="testAllWeatherAtTime(18)">18:00全天气</button>
        <button class="test-btn" onclick="testAllWeatherAtTime(22)">22:00全天气</button>
      </div>
    </div>

    <div class="control-group">
      <div class="control-title">全时段测试</div>
      <div class="button-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); font-size: 0.8rem;">
        <button class="test-btn" onclick="testWeatherAllTimes('clear')">Clear 全时段</button>
        <button class="test-btn" onclick="testWeatherAllTimes('rain')">Rain 全时段</button>
        <button class="test-btn" onclick="testWeatherAllTimes('thunderstorm')">Storm 全时段</button>
        <button class="test-btn" onclick="testWeatherAllTimes('snow')">Snow 全时段</button>
      </div>
    </div>
  </div>

  <div class="preview-section">
    <div class="preview-card">
      <div class="preview-title">悬浮球预览</div>
      <div class="floating-ball-preview">
        <div class="preview-ball" id="preview-ball">
          <div class="ball-icon" id="ball-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
          </div>
          <div class="ball-temp" id="ball-temp">23°</div>
        </div>
      </div>
    </div>

    <div class="preview-card">
      <div class="preview-title">当前主题信息</div>
      <div class="theme-info" id="theme-info">
        <div><strong>天气：</strong><span id="info-weather">晴天</span></div>
        <div><strong>时间：</strong><span id="info-time">12:00 (中午)</span></div>
        <div><strong>主题：</strong><span id="info-theme">clear-noon</span></div>
        <div><strong>背景：</strong><span class="color-swatch" id="swatch-bg"></span><span id="info-gradient">渐变</span></div>
        <div><strong>文字：</strong><span class="color-swatch" id="swatch-text"></span><span id="info-text-color">颜色</span></div>
      </div>
    </div>
  </div>

  <script src="js/icon-library.js"></script>
  <script src="js/theme-system.js"></script>
  <script>
    class ThemeTestPage {
      constructor() {
        this.currentWeather = 'clear';
        this.currentHour = 12;
        this.init();
      }

      init() {
        this.setupEventListeners();
        this.updateTheme();
      }

      setupEventListeners() {
        // 天气按钮
        document.querySelectorAll('.test-btn[data-weather]').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.test-btn[data-weather]').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            this.currentWeather = btn.dataset.weather;
            this.updateTheme();
          });
        });

        // 时间段按钮
        document.querySelectorAll('.test-btn[data-time]').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.test-btn[data-time]').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            this.currentHour = parseInt(btn.dataset.time);
            document.getElementById('time-slider').value = this.currentHour;
            document.getElementById('time-display').textContent = `${this.currentHour.toString().padStart(2, '0')}:00`;
            this.updateTheme();
          });
        });

        // 时间滑块
        const timeSlider = document.getElementById('time-slider');
        timeSlider.addEventListener('input', (e) => {
          this.currentHour = parseInt(e.target.value);
          document.getElementById('time-display').textContent = `${this.currentHour.toString().padStart(2, '0')}:00`;
          
          // 更新时间段按钮状态
          document.querySelectorAll('.test-btn[data-time]').forEach(btn => {
            btn.classList.remove('active');
            if (parseInt(btn.dataset.time) === this.currentHour) {
              btn.classList.add('active');
            }
          });
          
          this.updateTheme();
        });
      }

      updateTheme() {
        if (!window.unifiedTheme) {
          console.warn('主题系统未加载');
          return;
        }

        const isNight = this.currentHour < 6 || this.currentHour > 19;
        const theme = window.unifiedTheme.getTheme(this.currentWeather, this.currentHour, isNight);
        const timeSlot = window.unifiedTheme.getTimeSlot(this.currentHour, isNight);

        // 更新页面背景
        document.body.style.background = theme.gradient;
        document.body.style.color = theme.text;
        document.documentElement.style.setProperty('--theme-gradient', theme.gradient);
        document.documentElement.style.setProperty('--theme-text', theme.text);

        // 更新悬浮球预览
        const previewBall = document.getElementById('preview-ball');
        previewBall.style.background = theme.gradient;
        previewBall.style.color = theme.text;

        // 更新天气图标
        this.updateWeatherIcon();

        // 更新主题信息
        this.updateThemeInfo(theme, timeSlot);
      }

      updateWeatherIcon() {
        const iconElement = document.getElementById('ball-icon');
        const isNight = this.currentHour < 6 || this.currentHour > 19;
        
        // 使用统一图标库（如果可用）
        if (window.AeScapeIcons) {
          iconElement.innerHTML = window.AeScapeIcons.getWeatherIcon(this.currentWeather, isNight, 16);
          return;
        }
        
        // 备用图标
        const icons = {
          clear: isNight ? 
            `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>` :
            `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>`,
          cloudy: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>
          </svg>`,
          rain: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="16" y1="13" x2="16" y2="21"></line>
            <line x1="8" y1="13" x2="8" y2="21"></line>
            <line x1="12" y1="15" x2="12" y2="23"></line>
            <path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path>
          </svg>`,
          snow: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="2" y1="17" x2="22" y2="17"></line>
            <line x1="2" y1="12" x2="22" y2="12"></line>
            <line x1="2" y1="7" x2="22" y2="7"></line>
            <path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path>
          </svg>`,
          fog: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 15h18M3 9h18M3 21h18"></path>
          </svg>`,
          thunderstorm: `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 16.9A5 5 0 0 0 18 7h-1.26a8 8 0 1 0-11.62 9"></path>
            <polyline points="13 11,9 17,15 17,11 23"></polyline>
          </svg>`
        };
        
        iconElement.innerHTML = icons[this.currentWeather] || icons.clear;
      }

      updateThemeInfo(theme, timeSlot) {
        const weatherNames = {
          clear: '晴天',
          cloudy: '多云',
          rain: '雨天',
          snow: '雪天',
          fog: '雾天',
          thunderstorm: '雷暴'
        };

        const timeSlotNames = {
          dawn: '黎明',
          morning: '早晨',
          noon: '中午',
          afternoon: '下午',
          sunset: '日落',
          evening: '傍晚',
          night: '夜晚'
        };

        document.getElementById('info-weather').textContent = weatherNames[this.currentWeather];
        document.getElementById('info-time').textContent = `${this.currentHour.toString().padStart(2, '0')}:00 (${timeSlotNames[timeSlot]})`;
        document.getElementById('info-theme').textContent = `${this.currentWeather}-${timeSlot}`;
        document.getElementById('info-gradient').textContent = theme.gradient;
        document.getElementById('info-text-color').textContent = theme.text;

        // 更新颜色色块
        document.getElementById('swatch-bg').style.background = theme.primary || theme.gradient;
        document.getElementById('swatch-text').style.background = theme.text;
      }
    }

    // 快速测试场景
    function testScenario(weather, hour) {
      const testPage = window.themeTestPage;
      testPage.currentWeather = weather;
      testPage.currentHour = hour;
      
      // 更新UI控件
      document.querySelectorAll('.test-btn[data-weather]').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.weather === weather);
      });
      document.querySelectorAll('.test-btn[data-time]').forEach(btn => {
        btn.classList.toggle('active', parseInt(btn.dataset.time) === hour);
      });
      document.getElementById('time-slider').value = hour;
      document.getElementById('time-display').textContent = `${hour.toString().padStart(2, '0')}:00`;
      
      testPage.updateTheme();
    }

    // 测试指定时间的所有天气
    function testAllWeatherAtTime(hour) {
      const weathers = ['clear', 'cloudy', 'rain', 'snow', 'fog', 'thunderstorm'];
      let index = 0;
      
      function nextWeather() {
        if (index < weathers.length) {
          testScenario(weathers[index], hour);
          console.log(`测试: ${weathers[index]} at ${hour}:00`);
          index++;
          setTimeout(nextWeather, 2000); // 每2秒切换一次
        }
      }
      
      nextWeather();
    }

    // 测试指定天气的所有时间段
    function testWeatherAllTimes(weather) {
      const times = [5, 8, 10, 12, 15, 18, 19, 22];
      let index = 0;
      
      function nextTime() {
        if (index < times.length) {
          testScenario(weather, times[index]);
          console.log(`测试: ${weather} at ${times[index]}:00`);
          index++;
          setTimeout(nextTime, 2000); // 每2秒切换一次
        }
      }
      
      nextTime();
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
      window.themeTestPage = new ThemeTestPage();
    });
  </script>
</body>
</html>